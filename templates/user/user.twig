{% extends "base.twig" %}

{% block content %}

	<div class="headerUser">
		<h1><img class="pictureUser" src="{{ userSession.picture ? '/public/assets/images/uploads/' ~ userSession.picture : '/public/assets/images/portrait.png' }}" alt=""/>Bien le bonjour
			<span class="nameUser">{{ userSession.name }}</span>
			!</h1>
		<a href="/user/{{ userSession.id }}/form"><img class="post_img" src="/public/assets/images/article.png" alt="modifier mes données"/></a>
	</div>

	{% if userSession.role %}

		{% if allPosts is not empty %}
			<ul class="">

				{% for post in allPosts %}
					<li class="post post-{{post.status}}">
						<div>
							<h3 class="post_title"><img class="post_img" src="/public/assets/images/article.png" alt="logo" />{{ post.title }}</h3>
							<p>{{ post.chapo }}</p>
							<p class="post_author">{{ post.user ? post.user.name : 'Autheur inconnue' }}</p>
							<p>{{ post.updated_at is not empty ? post.updated_at : post.createdAt }}</p>
						</div>
						<ul class="post_btn_list">
						
							<li class="btn">
								<a class="post_delete" href="/post/{{ post.id }}/update/archive">Supprimer<img class="" src="/public/assets/images/poubelle.png" alt="supprimer l'article"/></a>
							</li>
							<li class="btn">
								<a class="post_read" href="/post/{{ post.id }}">Voir<img class="" src="/public/assets/images/vision.png" alt="voir l'article"/></a>
							</li>
							<li class="btn">
								<a class="post_update" href="/post/{{ post.id }}/update">Modifier<img class="" src="/public/assets/images/article.png" alt="modifier l'article"/></a>
							</li>
						</ul>
					</li>
				{% endfor %}	
			</ul>
			<div class="link_see_all_posts"><a class="btn" href="/admin/posts">Voir tous les posts</a></div>

		{% endif %}

		<h2>Post :</h2>
		<ul class="choicePostUser">
			<li class="postUser">
				<a href="/user/{{ userSession.id }}/formPost">
					Ecrire un nouveau post
					<img class="post_img" src="/public/assets/images/article.png" alt="écrire un post"/></a>
			</li>

			<li>
				<form class="postUser" action="/listPost" method="post">
					<button class="btn" type="submit">Voir tous les posts</button>
				</form>
			</li>
		</ul>

		<h2>Vos commentaires à étudier :</h2>
		<ul>
			{% if commentsForValidation|length < 1 %}
				<li class="commentUser">
					<div>
						<p class="comment_body">Il n'y a pas de commentaire en attentent de validation</p>

					</div>
				</li>
			{% endif %}
			{% for comment in commentsForValidation %}
				<li class="commentUser commentUser-{{ comment.status }}">
					<div>
						<p class="comment_body">{{ comment.body }}</p>
						<p>{{ comment.updated_at is not empty ? comment.updated_at : comment.createdAt|date("l d F à G\\hi") }}</p>
						<p class="comment_author">{{ comment.user.name }}</p>
					</div>

					<div class="comment_validation">
						<form action="/comment/{{ comment.id }}/update" method="post">
							<input hidden type="text" name="action" value="validated">
							<button class="comment_accepted" type="submit"><img class="" src="/public/assets/images/valider.png" alt="valider le commentaire"/></button>
						</form>
						<form action="/comment/{{ comment.id }}/update" method="post">
							<input hidden type="text" name="action" value="refused">
							<button class="comment_refused" type="submit"><img class="" src="/public/assets/images/rejeter.png" alt="rejeter le commentaire"/></button>
						</form>
					</div>
				</li>
			{% endfor %}
		</ul>
	{% endif %}

	<h2>Vos commentaires :</h2>

	{% if commentsByUser is not empty %}
		<ul>
			{% for comment in commentsByUser %}
				<li class="commentUser commentUser-{{ comment.status }}">
					<div>
						<p class="comment_body">{{ comment.body }}</p>
						<p>{{ comment.updated_at is not empty ? comment.updated_at : comment.createdAt|date("l d F à G\\hi") }}</p>
						<p class="comment_author">{{ comment.user.name }}</p>
					</div>

					<a class="comment_delete" href="{{ post.id }}/deleteComment/{{ comment.id }}"><img class="" src="/public/assets/images/poubelle.png" alt="supprimer"/></a>

				</li>
			{% endfor %}
		</ul>

	{% else %}
		<p>Vous n'avez pas encore écrit de commentaire !</p>
	{% endif %}

{% endblock %}
